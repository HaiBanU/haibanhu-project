<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cài đặt - HaiBanhU</title>
    <link rel="stylesheet" href="../common.css">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/profile.css">
    <link rel="stylesheet" href="../css/sidebar.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <!-- Thêm vào trước thẻ đóng </head> -->
<script src="https://cdn.jsdelivr.net/npm/leader-line-new@1.1.9/leader-line.min.js"></script>
</head>
<body class="light-mode">
    <div id="toast-container"></div>
    <header>
        <div class="container">
            <a href="home.html" class="logo nav-link" data-page="home"><img src="../images/logo-final.png" alt="HaiBanhU Logo"><span>HaiBanhU</span></a>
            <div id="search-container"><i class="fas fa-search"></i><input type="search" id="main-search-bar" placeholder="Tìm kiếm người dùng, kỹ năng..."></div>
            <nav>
                <a href="home.html" class="nav-item nav-link" data-page="home"><i class="fas fa-home"></i> <span>Trang chủ</span></a>
                <div id="features-menu" class="dropdown">
                    <button id="features-menu-btn" class="nav-menu-toggle"><i class="fas fa-th-large"></i><span>Chức năng</span><i class="fas fa-chevron-down"></i></button>
                    <div id="features-menu-dropdown" class="dropdown-menu hidden">
                         <a href="projects.html" class="nav-link" data-page="projects"><i class="fas fa-table-columns"></i> Dự án</a>
                         <a href="automation.html" class="nav-link" data-page="automation"><i class="fas fa-robot"></i> Tự động hóa</a>
                         <a href="image-studio.html" class="nav-link" data-page="image-studio"><i class="fas fa-palette"></i> Xưởng Ảnh AI</a>
                         <a href="calendar.html" class="nav-link" data-page="calendar"><i class="fas fa-calendar-alt"></i> Lịch</a>
                    </div>
                </div>
                <div id="nav-actions">
                    <button id="notification-btn" class="nav-icon-btn"><i class="fas fa-bell"></i><span id="notification-count" class="hidden">0</span></button>
                    <div id="notification-dropdown" class="hidden"></div>
                    <button id="dark-mode-toggle" class="dark-mode-btn"><i class="fa-solid fa-circle-half-stroke"></i></button>
                </div>
                <div id="user-menu" class="dropdown hidden">
                    <button id="user-menu-btn" class="user-menu-toggle"><img id="user-avatar-nav" src="../images/default-avatar.png" alt="User Avatar" onerror="this.onerror=null; this.src='../images/default-avatar.png';"><span id="username-display"></span><i class="fas fa-chevron-down"></i></button>
                    <div id="user-menu-dropdown" class="dropdown-menu hidden">
                        <div class="dropdown-header"><span id="dropdown-username"></span><span id="dropdown-email"></span></div>
                        <div class="dropdown-divider"></div>
                        <a href="profile.html" class="nav-link" data-page="profile"><i class="fas fa-user-circle"></i> Hồ sơ của bạn</a>
                        <a href="settings.html" class="nav-link" data-page="settings"><i class="fas fa-cog"></i> Cài đặt</a>
                        <div class="dropdown-divider"></div>
                        <a href="#" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Đăng xuất</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main>
        <section id="settings-view" class="container">
            <div class="page-header-banner"><div class="banner-content"><h2><i class="fa-solid fa-cog"></i> Cài đặt</h2><p>Quản lý thông tin tài khoản, bảo mật và các liên kết ứng dụng của bạn.</p></div></div>
            <div class="settings-tabs" id="settings-tabs-container"><button class="settings-tab-btn active" data-tab="account">Tài khoản</button><button class="settings-tab-btn" data-tab="connections">Liên kết</button><button class="settings-tab-btn" data-tab="danger">Vùng nguy hiểm</button></div>
            <div class="settings-grid">
                <div id="settings-tab-account" class="settings-tab-content active"><div class="profile-card"><h3>Đổi mật khẩu</h3><form id="change-password-form"><div class="form-group"><label for="current-password">Mật khẩu hiện tại</label><input type="password" id="current-password" required></div><div class="form-group"><label for="new-password">Mật khẩu mới</label><input type="password" id="new-password" required></div><div class="form-group"><label for="confirm-new-password">Xác nhận mật khẩu mới</label><input type="password" id="confirm-new-password" required></div><div class="form-actions"><button type="submit" class="btn btn-primary full-width">Lưu Mật khẩu</button></div></form></div></div>
                <div id="settings-tab-connections" class="settings-tab-content"><div class="profile-card"><h3>Liên kết ứng dụng</h3><p class="form-help-text">Kết nối tài khoản của bạn với các dịch vụ khác để mở khóa các tính năng tự động hóa.</p><div id="connections-list"></div></div></div>
                <div id="settings-tab-danger" class="settings-tab-content"><div class="profile-card danger-zone-card"><h3>Xóa tài khoản</h3><p>Hành động này không thể hoàn tác. Toàn bộ dự án, quy trình và dữ liệu của bạn sẽ bị xóa vĩnh viễn.</p><button id="delete-account-btn" class="btn btn-danger">Xóa tài khoản của tôi</button><div id="delete-account-verification" class="hidden"><p>Để xác nhận, vui lòng nhập tên tài khoản của bạn (<strong id="delete-username-confirm"></strong>) vào ô bên dưới.</p><div class="form-group"><input type="text" id="delete-confirm-input" placeholder="Nhập tên tài khoản của bạn"></div><button id="final-delete-btn" class="btn btn-danger full-width" disabled>Tôi hiểu, Xóa tài khoản vĩnh viễn</button></div></div></div>
            </div>
        </section>
    </main>
    
    <button id="toggle-sidebar-btn" class="nav-icon-btn hidden"><i class="fas fa-chevron-left"></i></button>
    <aside id="right-sidebar" class="hidden">
        <div class="friends-panel">
            <div class="sidebar-panel-header"><h4><i class="fas fa-user-friends"></i> Bạn bè</h4></div>
            <div id="friends-list-container"><div id="ai-assistant-chat-item" class="friend-item" data-action="open-chat" data-friend-id="ai"><div class="friend-avatar ai-avatar"><i class="fas fa-robot"></i></div><div class="friend-name">Người bạn AI</div><div class="friend-status online"></div></div></div>
        </div>
    </aside>

    <div id="modal-backdrop" class="hidden"></div>
    <div id="confirmation-modal" class="modal hidden"><div class="confirmation-content"><h3 id="confirmation-title">Xác nhận hành động</h3><p id="confirmation-message">Bạn có chắc chắn muốn tiếp tục?</p></div><div class="confirmation-actions"><button id="confirm-btn" class="btn btn-danger">Xác nhận</button><button id="cancel-btn" class="btn btn-secondary">Hủy</button></div></div>
    
    <div id="user-chat-container"></div>
    <div id="minimized-chats-container"></div>
    <div id="chat-box-template" class="chat-box hidden">
        <div class="chat-box-header"><div class="chat-box-recipient"><div class="chat-box-header-avatar"></div><span class="chat-box-title"></span></div><div class="chat-box-controls"><button class="chat-header-btn minimize-btn" title="Thu nhỏ"><i class="fas fa-minus"></i></button><button class="chat-header-btn chat-close-btn" title="Đóng"><i class="fas fa-times"></i></button></div></div>
        <div class="chat-box-content"><div class="chat-box-messages"></div><div class="chat-box-input-area"><div class="chat-input-prefix-actions"><button class="chat-action-btn" data-chat-action="attach-file" title="Đính kèm tệp"><i class="fas fa-paperclip"></i></button><button class="chat-action-btn" data-chat-action="send-image" title="Gửi ảnh"><i class="fas fa-image"></i></button></div><div class="chat-input-wrapper"><textarea class="chat-input-textarea" placeholder="Aa" rows="1"></textarea></div><button class="chat-action-btn send-btn" title="Gửi"><i class="fas fa-paper-plane"></i></button><input type="file" class="hidden" data-chat-action-input="file"><input type="file" class="hidden" data-chat-action-input="image" accept="image/*"></div></div>
    </div>
    
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/sidebar.js"></script>
    <script src="../js/profile.js"></script>
</body>
</html>